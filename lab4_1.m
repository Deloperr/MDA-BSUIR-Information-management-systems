% Тема: ПРЕДСТАВЛЕНИЕ ДАННЫХ РЯДАМИ ТЕЙЛОРА: МНОГОМЕРНО-МАТРИЧНЫЙ ПОДХОД
% Классический полином: y = 2*x1^2 - 2*x2^2 + 3*x1*x2
clc; clear; close all;

% 1. Задаем область построения графиков
x1 = linspace(-5, 5, 50);
x2 = linspace(-5, 5, 50);
[X1, X2] = meshgrid(x1, x2);

% 2. Расчет классического полинома
Y_classic = 2*X1.^2 - 2*X2.^2 + 3*X1.*X2;

% 3. Расчет многомерно-матричного полинома
% Матрица коэффициентов c2
c2 = [2, 1.5; 1.5, -2]; 

% Инициализация матрицы для значений
Y_matrix = zeros(size(X1));

% Расчет значения для каждой точки (X1(i,j), X2(i,j))
% Используем прямое определение (4.8): y = 0 + c1*x + c2*x^2
% c1 = [0, 0], поэтому первое слагаемое равно 0.
for i = 1:length(x1)
    for j = 1:length(x2)
        x_vec = [X1(i,j); X2(i,j)]; % Вектор [x1; x2] в точке (i,j)
        % Вычисляем x^2 как внешнее произведение (дает матрицу)
        x_squared = x_vec * x_vec';
        % Вычисляем 0.2(c2 * x^2) как поэлементное умножение и суммирование
        % Это эквивалентно sum(c2 .* x_squared, 'all') в новых версиях Matlab
        quadratic_term = sum(sum(c2 .* x_squared));
        Y_matrix(i,j) = 0 + quadratic_term;
    end
end

% 4. Построение графиков для сравнения
figure('Name', 'ЛР4: Сравнение классической и матричной форм');
subplot(1,2,1);
meshc(X1, X2, Y_classic);
title('Классическая форма: y=2x1^2-2x2^2+3x1x2');
xlabel('x1'); ylabel('x2'); zlabel('y');

subplot(1,2,2);
meshc(X1, X2, Y_matrix);
title('Многомерно-матричная форма');
xlabel('x1'); ylabel('x2'); zlabel('y');

% 5. Проверка совпадения (погрешность должна быть близка к нулю)
error = max(abs(Y_classic(:) - Y_matrix(:)));
disp(['Максимальная ошибка между формами: ', num2str(error)]);