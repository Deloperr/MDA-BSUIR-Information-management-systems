% Тема: Представление данных рядами Тейлора (многомерно-матричный подход)
clc;   
clear;  

% Объявляем символьные переменные
syms x x1 x2 a1 a2;

% 1. Задаём исходную функцию одной переменной
f = (x - 1)^2 - sin(2*x);

% 2. Разложение функции в ряд Тейлора до 2-й степени в окрестности точки x=0
taylor_f = taylor(f, x, 'ExpansionPoint', 0, 'Order', 3);
disp('Ряд Тейлора функции одной переменной до 2-й степени:');
disp(taylor_f);

% 3. Переход к функции двух переменных
%    Подставляем: x = a1*x1 + a2*x2
x_sub = a1*x1 + a2*x2;
f2 = subs(f, x, x_sub);

% 4. Разложение функции двух переменных в ряд Тейлора
%    до 2-й степени в окрестности точки (0,0)
taylor_f2 = taylor(f2, [x1 x2], 'ExpansionPoint', [0 0], 'Order', 3);
disp('Ряд Тейлора функции двух переменных до 2-й степени:');
disp(taylor_f2);

% 5. Подготовка к визуализации
%    Строим сетку значений переменных x1 и x2
[X1, X2] = meshgrid(-2:0.1:2, -2:0.1:2);  % сетка от -2 до 2
a1_val = 1;   % задаём коэффициенты a1 и a2
a2_val = 1;

% 6. Преобразуем символьные выражения в численные функции
%    matlabFunction позволяет использовать их как обычные функции
F = matlabFunction(subs(f2, {a1,a2}, {a1_val,a2_val}), 'Vars', {x1,x2});
F_taylor = matlabFunction(subs(taylor_f2, {a1,a2}, {a1_val,a2_val}), 'Vars', {x1,x2});

% 7. Вычисляем значения функции и её аппроксимации на сетке
Z1 = F(X1, X2);        % исходная функция
Z2 = F_taylor(X1, X2); % аппроксимация Тейлора

% 8. Построение графиков
%    В одном окне показываем обе поверхности
figure;
mesh(X1, X2, Z1);      % график исходной функции
hold on;
mesh(X1, X2, Z2);      % график аппроксимирующего полинома
title('Функция и её аппроксимация рядом Тейлора (2-я степень)');
legend('Исходная функция','Аппроксимация Тейлора');
grid on;
